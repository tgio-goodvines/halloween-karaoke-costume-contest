{% extends "base.html" %}
{% set title = "Costume Contest Signup" %}

{% block content %}
{% if costume_contest_state.voting_open %}
  <section class="contest-banner contest-banner--voting">
    <div class="contest-banner__body">
      <h2>Voting Has Begun!</h2>
      <p>Grab a ballot and score every costume from 1-10 to help choose the champion.</p>
    </div>
    <a class="contest-banner__button" href="{{ url_for('costume_voting_page') }}">Cast Your Votes</a>
  </section>
{% elif costume_contest_state.winner_locked and costume_contest_state.winner %}
  <section class="contest-banner contest-banner--winner">
    <div class="contest-banner__body">
      <h2>We Have a Winner!</h2>
      <p>
        <strong>{{ costume_contest_state.winner.name }}</strong> wowed the crowd as
        <strong>{{ costume_contest_state.winner.costume }}</strong>.
      </p>
      <p class="contest-banner__meta">
        Avg Score: {{ '%.2f' | format(costume_contest_state.winner.average) }} â€¢ Votes:
        {{ costume_contest_state.winner.count }}
      </p>
    </div>
  </section>
{% endif %}

<section class="form-section">
  <h2>Costume Contest Signup</h2>
  <p>Tell us who you are and what spectacular costume you'll be wearing.</p>

  {% if submitted and not errors %}
    <div class="success">Thank you for signing up! We can't wait to see your costume.</div>
  {% endif %}

  {% if errors %}
    <div class="errors">
      <ul>
        {% for error in errors %}
          <li>{{ error }}</li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  <form method="post" class="signup-form">
    <label for="name">Name *</label>
    <input type="text" id="name" name="name" required>

    <label for="costume">Costume *</label>
    <input type="text" id="costume" name="costume" required>

    <button type="submit">Submit Costume</button>
  </form>
</section>

<section class="submitted-list">
  <h3>Submitted Costumes</h3>
  {% if costume_signups %}
    <ul>
      {% for signup in costume_signups %}
        <li>
          <strong>{{ signup.name }}</strong> as {{ signup.costume }}{% if signup.contact %} &mdash; {{ signup.contact }}{% endif %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No entries yet. Submit yours above!</p>
  {% endif %}
</section>
{% endblock %}
