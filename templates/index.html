{% extends "base.html" %}
{% set title = "Party Dashboard" %}

{% block content %}
{% if costume_contest_state.voting_open %}
  <section class="contest-banner contest-banner--voting">
    <div class="contest-banner__body">
      <h2>Cast Your Costume Contest Votes</h2>
      <p>The contest is underway! Score each costume from 1-10 to help choose tonight's champion.</p>
    </div>
    <a class="contest-banner__button" href="{{ url_for('costume_voting_page') }}">Start Voting</a>
  </section>
{% elif costume_contest_state.winner_locked and costume_contest_state.winner %}
  <section class="contest-banner contest-banner--winner">
    <div class="contest-banner__body">
      <h2>Costume Contest Champion</h2>
      <p>
        Congratulations to <strong>{{ costume_contest_state.winner.name }}</strong> for portraying
        <strong>{{ costume_contest_state.winner.costume }}</strong>!
      </p>
      <p class="contest-banner__meta">
        Avg Score: {{ '%.2f' | format(costume_contest_state.winner.average) }} • Votes:
        {{ costume_contest_state.winner.count }}
      </p>
    </div>
  </section>
{% endif %}

<section class="signup-callout">
  <div class="signup-callout__intro">
    <h2>Welcome to the Party Portal</h2>
    <p>
      You're already connected—now use this hub to join the costume contest, reserve a karaoke song, and keep up with
      the latest signups.
    </p>
  </div>
</section>

<section class="slides">
  <h2>Event Highlights</h2>
  <div class="slides-wrapper">
    {% for slide in slides %}
      <article class="slide{% if loop.first %} active{% endif %}">
        <h3>{{ slide.title }}</h3>
        <p>{{ slide.content }}</p>
      </article>
    {% endfor %}
  </div>
</section>

<section class="signup-summary">
  <div>
    <h2>Costume Contest Signups</h2>
    {% if costume_signups %}
      <ul>
        {% for signup in costume_signups %}
          <li>
            <strong>{{ signup.name }}</strong> as {{ signup.costume }}{% if signup.contact %} &mdash; {{ signup.contact }}{% endif %}
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No costume signups yet. <a href="{{ url_for('costume_signup') }}">Be the first!</a></p>
    {% endif %}
  </div>
  <div>
    <h2>Karaoke Signups</h2>
    {% if karaoke_signups %}
      <ul>
        {% for signup in karaoke_signups %}
          <li>
            <strong>{{ signup.name }}</strong> &mdash; "{{ signup.song_title }}"{% if signup.artist %} by {{ signup.artist }}{% endif %}
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No karaoke signups yet. <a href="{{ url_for('karaoke_signup') }}">Choose a song!</a></p>
    {% endif %}
  </div>
</section>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename='slides.js') }}"></script>
{% endblock %}
